(this["webpackJsonpsharing-economy-app"]=this["webpackJsonpsharing-economy-app"]||[]).push([[0],{46:function(e,t,a){e.exports=a(94)},51:function(e,t,a){},73:function(e,t,a){},75:function(e,t,a){},76:function(e,t,a){},77:function(e,t,a){},82:function(e,t,a){},94:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(13),i=a.n(c),o=a(35),s=a(36),l=a(44),u=a(37),d=a(45),m=(a(51),a(2)),p=a(3),f=a.n(p),E=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:"GET_ERRORS",payload:{msg:e,status:t,id:a}}},h=a(4),b=a(12),g=(a(73),function(){var e=Object(n.useState)(""),t=Object(m.a)(e,2),a=t[0],c=t[1],i=Object(n.useState)(""),o=Object(m.a)(i,2),s=o[0],l=o[1],u=Object(n.useState)(""),d=Object(m.a)(u,2),p=d[0],g=d[1],v=Object(n.useState)(""),O=Object(m.a)(v,2),S=O[0],y=O[1],_=Object(n.useState)(""),j=Object(m.a)(_,2),N=j[0],R=j[1],C=Object(n.useState)(""),k=Object(m.a)(C,2),I=k[0],L=k[1],w=Object(n.useState)(!1),T=Object(m.a)(w,2),A=T[0],F=T[1],G=Object(n.useState)(!1),D=Object(m.a)(G,2),U=D[0],x=D[1],J=Object(h.b)(),B=function(e,t){switch(e.preventDefault(),t){case"firstname":c(e.target.value);break;case"lastname":l(e.target.value);break;case"username":g(e.target.value);break;case"email":y(e.target.value);break;case"password":R(e.target.value);break;case"confirm-password":L(e.target.value);break;default:return}};return U?r.a.createElement(b.a,{to:"/"}):r.a.createElement("div",null,r.a.createElement("div",{className:"login-container"},A?r.a.createElement("div",null,r.a.createElement("input",{type:"text",className:"firstname-field h-align",placeholder:"First Name",onChange:function(e){return B(e,"firstname")}}),r.a.createElement("input",{type:"text",className:"lastname-field h-align",placeholder:"Last Name",onChange:function(e){return B(e,"lastname")}}),r.a.createElement("input",{type:"text",className:"username-field h-align",placeholder:"Username",onChange:function(e){return B(e,"username")}})):null,r.a.createElement("div",{className:"hive-login-container"},r.a.createElement("a",{href:"https://api.intra.42.fr/oauth/authorize?client_id=8f7dbe7ac964071bad261bdc3197b8c40b26a2bc5105046c3245ab2635a28ecb&redirect_uri=http%3A%2F%2Flocalhost%3A3000%2Foauth%2F42%2Fredirect&response_type=code&scope=public"},"Login with hive")),r.a.createElement("input",{className:"email-field h-align",type:"email",placeholder:"Email",onChange:function(e){return B(e,"email")}}),r.a.createElement("input",{type:"password",placeholder:"Password",className:"pasword-field h-align",onChange:function(e){return B(e,"password")}}),A?r.a.createElement("div",null,r.a.createElement("input",{type:"password",placeholder:"Confirm Password",className:"confirm-pasword-field h-align",onChange:function(e){return B(e,"confirm-password")}})):null,r.a.createElement("button",{className:"submit-button h-align",onClick:function(){A?N!==I?alert("passwords don't match"):(!function(e){var t=e.firstname,a=e.lastname,n=e.username,r=e.email,c=e.password;return function(e){var i=JSON.stringify({firstname:t,lastname:a,username:n,email:r,password:c});f.a.post("/api/users",i,{headers:{"Content-type":"application/json"}}).then((function(t){e({type:"REGISTER_SUCCESS",payload:t.data})})).catch((function(t){E(t.response.data,t.response.status,"REGISTER_FAIL"),e({type:"REGISTER_FAIL"})}))}}({firstname:a,lastname:s,username:p,email:S,password:N})(J),x(!0)):(!function(e){var t=e.email,a=e.password;return function(e){var n=JSON.stringify({email:t,password:a});f.a.post("/api/auth",n,{headers:{"Content-type":"application/json"}}).then((function(t){e({type:"LOGIN_SUCCESS",payload:t.data})})).catch((function(t){E(t.response.data,t.response.status,"LOGIN_FAIL"),e({type:"LOGIN_FAIL"})}))}}({email:S,password:N})(J),x(!0))}},A?r.a.createElement("div",null,"REGISTER"):r.a.createElement("div",null,"LOGIN")),A?null:r.a.createElement("div",{className:"register-link"},r.a.createElement("div",{onClick:function(){F(!0)}},"Don't have an account yet?"))))}),v=(a(75),function(e){var t=Object(n.useState)(!1),a=Object(m.a)(t,2),c=a[0],i=a[1],o=Object(h.c)((function(e){return e.auth.user})),s=e.offer,l=s.creator.profile_picture?s.creator.profile_picture:"/default.png",u=function(){var e=JSON.stringify({_id:o._id,firstname:o.firstname,lastname:o.lastname,username:o.username}),t=JSON.stringify({notification:{type:"sale",title:"Your Offer Was Bought",text:o.username+" bought your offer "+s.title+" for "+s.cost+" schmeckels!",isRead:!1,date:Date.now()}});!function(e,t){var a={headers:{"Content-type":"application/json",id:e}};f.a.put("/api/offers",t,a).then((function(e){return console.log(e.data)})).catch((function(e){return console.log(e)}))}(s._id,e),function(e,t){console.log(e+" "+t);var a={headers:{"Content-type":"application/json",id:e}};f.a.put("/api/users",t,a).then((function(e){return console.log(e.data)})).catch((function(e){return console.log(e)}))}(s.creator.id,t)};return r.a.createElement("div",null,r.a.createElement("div",{className:"offer-card",onClick:function(){return i(!c)}},r.a.createElement("div",{className:"user-info"},r.a.createElement("div",{id:"username"},s.creator.username),r.a.createElement("img",{src:l,alt:"profilePic",id:"profile-pic"}),r.a.createElement("div",{className:"karma-container"},r.a.createElement("img",{src:"/karma.png",alt:"karma",id:"karma-icon"}),r.a.createElement("div",{id:"karma"},s.creator.karma))),r.a.createElement("div",{className:"offer-info"},r.a.createElement("div",{id:"type"},s.type.toUpperCase()),r.a.createElement("div",{id:"title"},s.title.toUpperCase()),r.a.createElement("div",{className:"const-container"},r.a.createElement("img",{src:"/money-bag.png",alt:"money",id:"cost-icon"}),r.a.createElement("div",{id:"cost"},s.cost)),r.a.createElement("div",{id:"tags"},"sports | tennis | skillshare"))),c?r.a.createElement("div",{className:"details-container"},r.a.createElement("div",{id:"description"},'"',s.description,'"'),r.a.createElement("button",{id:"buy-button",onClick:function(){return u()}},"BUY")):null)}),O=(a(76),function(){var e=Object(n.useState)(!1),t=Object(m.a)(e,2),a=t[0],c=t[1],i=Object(n.useState)(!1),o=Object(m.a)(i,2),s=o[0],l=o[1],u=Object(h.c)((function(e){return e.auth.isAuthenticated})),d=Object(h.b)();return s?r.a.createElement(b.a,{to:"/login"}):r.a.createElement("div",null,r.a.createElement("div",{className:"navbar-container"},r.a.createElement("img",{src:"/hamburger.png",alt:"hamburger",id:"hamburger",onClick:function(){c(!a)}}),r.a.createElement("img",{src:"/pig.png",alt:"logo",id:"logo"})),a?r.a.createElement("div",{className:"hamburger-menu"},u?r.a.createElement("div",null,r.a.createElement("div",{className:"menu-item"},"Menu item 1"),r.a.createElement("div",{className:"menu-item"},"Menu item 2"),r.a.createElement("div",{className:"menu-item"},"Menu item 3"),r.a.createElement("img",{src:"/logout.png",alt:"logout",id:"logout",onClick:function(){(function(e){e({type:"LOGOUT_SUCCESS"})})(d)}}),r.a.createElement("img",{src:"/settings.png",alt:"settings",id:"settings"})):r.a.createElement("button",{id:"login-button",onClick:function(){l(!0)}},"LOGIN")):null)}),S=a(18),y=(a(77),a(78),function(e){var t=Object(n.useState)(""),a=Object(m.a)(t,2),c=a[0],i=a[1],o=Object(n.useState)(0),s=Object(m.a)(o,2),l=s[0],u=s[1],d=Object(n.useState)(30),p=Object(m.a)(d,2),E=p[0],b=p[1],g=Object(n.useState)(""),O=Object(m.a)(g,2),y=O[0],_=O[1],j=Object(n.useState)(""),N=Object(m.a)(j,2),R=N[0],C=N[1],k=Object(n.useState)(!1),I=Object(m.a)(k,2),L=I[0],w=I[1],T=Object(h.c)((function(e){return e.auth.user})),A=Object(h.b)(),F=function(e){var t="increase"===e?1:-1;t<0&&E>15?b(E-15):t>0&&E<240&&b(E+15)},G=function(e,t){switch(t){case"type":C(e.target.value);break;case"cost":u(e.target.value);break;case"isTradeable":w(e.target.checked);break;case"title":i(e.target.value);break;case"description":_(e.target.value);break;default:return}},D=function(){var t={id:T._id,username:T.username,karma:T.karma,profile_picture:T.profile_picture};Date.prototype.addDays=function(e){var t=new Date(this.valueOf());return t.setDate(t.getDate()+e),t};var a=(new Date).addDays(7);!function(e){return function(t){f.a.post("/api/offers",e,{headers:{"Content-type":"application/json"}}).then((function(e){t({type:"ADD_OFFER_SUCCESS",payload:e.data})}))}}({creator:t,cost:l,type:R,expiresDate:a,description:y,duration:E,title:c,isTradeable:L})(A),e.setIsAdd(!1)};return r.a.createElement(S.a,{classname:"carousel",interval:null,wrap:!1},r.a.createElement(S.a.Item,{className:"carousel-item"},r.a.createElement("div",{className:"grid"},r.a.createElement("h1",{className:"header center"},"DESCRIPTION"),r.a.createElement("input",{type:"text",placeholder:"TITLE",id:"title-field",onChange:function(e){return G(e,"title")}}),r.a.createElement("textarea",{rows:"6",cols:"30",placeholder:"Give a brief description about your offering",id:"description-field",onChange:function(e){return G(e,"description")}}))),r.a.createElement(S.a.Item,null,r.a.createElement("div",{className:"grid"},r.a.createElement("h1",{className:"header center"},"DETAILS"),r.a.createElement("select",{name:"type",className:"center",id:"type-dropdown",defaultValue:"",onChange:function(e){return G(e,"type")}},r.a.createElement("option",{value:"",disabled:!0},"Choose Category.."),r.a.createElement("option",{value:"lesson"},"Lesson"),r.a.createElement("option",{value:"rent"},"Rent"),r.a.createElement("option",{value:"sell"},"Sell")),r.a.createElement("input",{type:"number",name:"cost",id:"cost-field",className:"center",placeholder:"price",onChange:function(e){return G(e,"cost")}}),r.a.createElement("div",{className:"center",id:"tradeable-field"},r.a.createElement("input",{type:"checkbox",name:"isTradeable",id:"is-tradeable-box",className:"center",onClick:function(e){return G(e,"isTradeable")}}),r.a.createElement("label",{htmlFor:"isTradeable"},"Allow Trade Offers?")),"lesson"===R?r.a.createElement("div",{id:"input-duration"},r.a.createElement("div",{className:"center",id:"label-duration"},"Lesson Duration:"),r.a.createElement("button",{className:"center",id:"duration-minus",onClick:function(){return F("decrease")}},"-"),r.a.createElement("div",{id:"duration-value",className:"center"},function(e){var t=e%60;return Math.floor(e/60)+":"+t+(t<10?"0":"")+" h"}(E)),r.a.createElement("button",{className:"center",id:"duration-plus",onClick:function(){return F("increase")}},"+")):null)),r.a.createElement(S.a.Item,{className:"carousel-item"},r.a.createElement(v,{offer:{creator:{id:T._id,username:T.username,karma:T.karma,profile_picture:T.profile_picture},cost:l,type:R,description:y,duration:E,title:c,isTradeable:L}}),r.a.createElement("button",{id:"submit-button",onClick:function(){return D()}},"SUBMIT")))}),_=(a(82),function(){var e=Object(h.c)((function(e){return e.offer.offers})),t=Object(n.useState)(!1),a=Object(m.a)(t,2),c=a[0],i=a[1];return e[0]?r.a.createElement("div",null,r.a.createElement(O,null),c?r.a.createElement("div",{className:"add-offer-container"},r.a.createElement(y,{setIsAdd:i})):r.a.createElement("div",null,r.a.createElement("div",{className:"cards-container"},e.reverse().map((function(e){return r.a.createElement(v,{offer:e,key:e._id})}))),r.a.createElement("img",{src:"/add.png",alt:"plus",id:"add-button",onClick:function(){return i(!0)}}))):r.a.createElement("div",null,"wait")}),j=a(41),N=a.n(j),R=function(e){return function(t){var a=JSON.stringify({hive_id:e});f.a.post("/api/auth/hive",a,{headers:{"Content-type":"application/json"}}).then((function(e){t({type:"LOGIN_SUCCESS",payload:e.data})})).catch((function(e){E(e.response.data,e.response.status,"LOGIN_FAIL"),t({type:"LOGIN_FAIL"})}))}},C=function(){var e=Object(b.f)(),t=Object(h.b)(),a=Object(n.useState)(!1),c=Object(m.a)(a,2),i=c[0],o=c[1];return Object(n.useEffect)((function(){var a=e.search,n=N.a.parse(a).code;f.a.get("/oauth/42/redirect",{headers:{code:n}}).then((function(e){return f.a.get("https://api.intra.42.fr/v2/me",{headers:{Authorization:"BEARER "+e.data.access_token}})})).then((function(e){f.a.get("/api/users").then((function(a){for(var n=0;n<a.data.length;n++)if(a.data[n].hive_id===e.data.id)return R(e.data.id)(t),void o(!0);var r=e.data;!function(e){var t=e.firstname,a=e.lastname,n=e.username,r=e.email,c=e.profile_picture,i=e.hive_id;return function(e){var o=JSON.stringify({firstname:t,lastname:a,username:n,email:r,hive_id:i,profile_picture:c});f.a.post("/api/users/hive",o,{headers:{"Content-type":"application/json"}}).then((function(t){e({type:"REGISTER_SUCCESS",payload:t.data})})).catch((function(t){E(t.response.data,t.response.status,"REGISTER_FAIL"),e({type:"REGISTER_FAIL"})}))}}({firstname:r.first_name,lastname:r.last_name,username:r.login,email:r.email,hive_id:r.id,profile_picture:r.image_url})(t),o(!0)}))})).catch((function(e){return console.log(e)}))})),i?r.a.createElement(b.a,{to:"/"}):r.a.createElement("div",null,r.a.createElement("h1",null,"this is redirect component"))},k=a(16),I=a(11),L=a(42),w=a(8),T={users:[]},A={token:localStorage.getItem("token"),isAuthenticated:null,isLoading:!1,user:null},F={msg:{},status:null,id:null},G=a(43),D={offers:[],isLoading:!1},U=Object(I.c)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_USERS":return Object(w.a)({},e);default:return e}},error:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_ERRORS":return{msg:t.payload.msg,status:t.payload.status,id:t.payload.id};case"CLEAR_ERRORS":return{msg:{},status:null,id:null};default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USER_LOADING":return Object(w.a)({},e,{isLoading:!0});case"USER_LOADED":return Object(w.a)({},e,{isAuthenticated:!0,isLoading:!1,user:t.payload});case"LOGIN_SUCCESS":case"REGISTER_SUCCESS":return localStorage.setItem("token",t.payload.token),Object(w.a)({},e,{},t.payload,{isAuthenticated:!0,isLoading:!1});case"AUTH_ERROR":case"REGISTER_FAIL":case"LOGIN_FAIL":case"LOGOUT_SUCCESS":return localStorage.removeItem("token"),Object(w.a)({},e,{token:null,user:null,isAuthenticated:!1,isLoading:!1});default:return e}},offer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_OFFERS":return Object(w.a)({},e,{offers:t.payload,isLoading:!1});case"OFFERS_LOADING":return Object(w.a)({},e,{isLoading:!0});case"GET_OFFERS_ERROR":return Object(w.a)({},e,{offers:[],isLoading:!1});case"ADD_OFFER_SUCCESS":return Object(w.a)({},e,{offers:[].concat(Object(G.a)(e.offers),[t.payload])});default:return e}}}),x=[L.a],J=Object(I.e)(U,{},Object(I.d)(I.a.apply(void 0,x),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())),B=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){J.dispatch((function(e,t){e({type:"USER_LOADING"});var a=t().auth.token,n={headers:{"Content-type":"application/json"}};a&&(n.headers["x-auth-token"]=a),f.a.get("/api/auth/user",n).then((function(t){return e({type:"USER_LOADED",payload:t.data})})).catch((function(t){console.log(t),e(E(t.response.data,t.response.status)),e({type:"AUTH_ERROR"})}))})),J.dispatch((function(e){e({type:"OFFERS_LOADING"}),f.a.get("/api/offers").then((function(t){e({type:"GET_OFFERS",payload:t.data})})).catch((function(t){e(E(t.response.data,t.response.status)),e({type:"GET_OFFERS_ERROR"})}))}))}},{key:"render",value:function(){return r.a.createElement(h.a,{store:J},r.a.createElement(k.a,null,r.a.createElement(b.b,{path:"/",exact:!0,component:_}),r.a.createElement(b.b,{path:"/login",exact:!0,component:g}),r.a.createElement(b.b,{path:"/addoffer",exact:!0,component:y}),r.a.createElement(b.b,{path:"/oauth/42/redirect",exact:!0,component:C})))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(B,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[46,1,2]]]);
//# sourceMappingURL=main.3c4e5df4.chunk.js.map